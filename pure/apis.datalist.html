<!doctype html>
<html lang="zh-Hans-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="description" content="LuLu UI pure主题中文文档，面向PC，也兼容移动端，非常适合对外用户web网站的UI框架，阅文集团前端团队荣誉出品。本页面文档内容关于Datalist数据列表" />
<meta name="keywords" content="LuLu UI, 中文文档, UI框架, UI组件库, LuLu, Web, 前端, Datalist数据列表" />
<title>LuLu UI pure主题中文文档 &raquo; Datalist数据列表</title>
<link rel="stylesheet" href="https://qidian.gtimg.com/lulu/pure/css/common/animate.css">
<link rel="stylesheet" href="https://qidian.gtimg.com/lulu/pure/css/common/ui.css">
<link rel="stylesheet" href="../pure/assets/css/mockup.css">
</head>
<body>
	<input id="asideCheck" type="checkbox" class="aside-checkbox"><label for="asideCheck" class="aside-label"><svg width="24" height="24"><use xlink:href="#icon-bars"></use></svg></label>
	<header class="header">
		<a href="../" accesskey="1" class="logo-a" data-theme="pure"><h1 class="logo">LuLu UI pure版中文文档 &raquo; Datalist数据列表</h1></a>
		<div class="header-right">
			<select id="selectTheme" class="select-theme" is="ui-select">
				<option value="peak">Peak主题</option>
			    <option value="pure" selected>Pure主题</option>
			    <option value="edge">Edge主题</option>
			</select>
			<a href="https://github.com/yued-fe/lulu" class="fork-me ui-button">Fork Me</a>
		</div>
	</header>


<style type="text/css">
.datalist-container .ui-datalist {
    display: block!important;
    position: static!important;
}
.datalist-container .ui-datalist-datalist {
    margin-top: 10px;
    border: 1px solid #d0d0d5;
    box-shadow: none;
    padding: 0;
}
#app {
    height: 40px;
}
</style>

<div class="main">
    <!-- 主内容 -->
    <main class="section_main">
        <h2 class="section_title">Datalist数据列表</h2>
        <!-- 详细内容 -->
        <article>
            <p>Datalist组件是一个与输入框列表相关联的万能数据列表组件，可以用于各种常见的输入框下拉列表。</p>

            <h3>作为插件单独使用</h3>
            <p>引入CSS：</p>
            <pre>&lt;link rel="stylesheet" href="https://qidian.gtimg.com/lulu/pure/css/common/ui/Datalist.css"&gt;</pre>
            <p>引入JS：</p>
            <pre>&lt;script src="https://qidian.gtimg.com/lulu/pure/js/common/ui/Follow.js"&gt;&lt;/script&gt;
&lt;script src="https://qidian.gtimg.com/lulu/pure/js/common/ui/Datalist.js"&gt;&lt;/script&gt;</pre>

            <h3>&lt;datalist&gt;列表功能</h3>
            <p>借助原生的<code>&lt;datalist&gt;</code>元素实现数据列表功能，适合静态数据，语义更好，功能更健壮，JS异常用户也能无障碍使用。</p>
            <h4>1. 姓名匹配-基于元素（推荐）</h4>
            <p><span class="dib vt pt5">员工姓名：</span><input id="inputPerson" class="ui-input" list="datalistPerson"></p>
<datalist id="datalistPerson">
    <!--[if IE 9]><select disabled style="display:none"><![endif]-->
    <option value="蔡伦">
    <option value="郑成功">
    <option value="郑成功">
    <option value="李莲英">
    <option value="高松正">
    <option value="郑工">
    <option value="陈晓芳">
    <option value="李琳琳">
    <option value="彭大帅">
    <!--[if IE 9]></select><![endif]-->
</datalist>

            <p><strong>HTML代码</strong></p>
            <pre>&lt;input id="inputPerson" class="ui-input" <mark>list</mark>="datalistPerson"&gt;
<span class="green">&lt;!-- 员工数据 --&gt;</span>
&lt;datalist id="datalistPerson"&gt;
    <span class="gray">&lt;!--[if IE 9]&gt;&lt;select disabled style="display:none"&gt;&lt;![endif]--&gt;</span>
    &lt;option value="蔡伦"&gt;
    <span class="gray">...</span>
    &lt;option value="彭大帅"&gt;
    <span class="gray">&lt;!--[if IE 9]&gt;&lt;/select&gt;&lt;![endif]--&gt;</span>
&lt;/datalist&gt;</pre>
            <p><strong>JS代码</strong>
            <p>直接绑定Datalist方法即可：</p>
            <pre>new Datalist('#inputPerson');</pre>
            <p><strong>说明</strong></p>
            <ol>
                <li><code>&lt;input&gt;</code>输入框元素的<code>list</code>属性值和原生的<code>&lt;datalist&gt;</code>元素的<code>id</code>属性值保持一致即可。</li>
                <li><code>&lt;datalist&gt;</code> IE9浏览器不支持，会忽略其中的<code>&lt;option&gt;</code>元素，可以使用<code>&lt;!--[if IE 9]&gt;</code>条件注释嵌套一个<code>&lt;select&gt;</code>元素。<p>如果您的项目无需兼容IE9浏览器，可以去掉相关代码，另外，为了减少干扰，下面案例展示的源码就不显示IE9的条件注释代码了。</p></li>
                <li>我们可以在<code>&lt;input&gt;</code>元素上设置<code>results</code>属性指定显示最大的列表个数，可参考后面案例。默认最大显示列表个数是<code>8</code>项。</li>
                <li><code>&lt;datalist&gt;</code>列表输入框在点击时候，如果里面有值，会清空变成<code>placeholder</code>属性值，这样完整列表可以展示，增强体验。如果不希望是这样的交互，可以设置可选参数<code>placeholder</code>为<code>false</code>。</li>
            </ol>

            <h4>2. 姓名匹配-基于数据</h4>
            <p><span class="dib vt pt5">员工姓名：</span><input id="inputPerson2" class="ui-input" results="5"></p>
            <p>使用可选参数中的<code>data</code>传参，通过<code>&lt;input&gt;</code>输入框的<code>results</code>属性指定列表最多显示5项。</p>
            <pre>&lt;input id="inputPerson2" class="ui-input" <mark>results</mark>="5"&gt;</pre>
            <pre>new Datalist('#inputPerson2', {
    <span class="green">// 如果数据是动态变化的，请使用function类型</span>
    data: [{
        value: '蔡伦',
        id: 1
    }, {
        value: '李莲英',
        id: 2
    }, {
        value: '高松正',
        id: 3
    }, {
        value: '郑工',
        id: 4
    }, {
        value: '陈晓芳',
        id: 5
    }, {
        value: '李琳琳',
        id: 6
    }, {
        value: '彭大帅',
        id: 7
    }]
});</pre>

<h5>事件传参</h5>
<p>实际开发中，开发者更关心的是用户的ID，而不是姓名，此时，可以通过事件对象的<code>detail</code>属性获取，代码示意如下：</p>
<pre><span class="green">// 演示数据参数如何传递到事件中</span>
document.querySelector('#inputPerson2').addEventListener('change', function (event) {
    console.log('用户变化，当前用户id是：' + event.detail.id);
});</pre>
<p>在控制台就可以看到对应的输出。</p>
            <h4>3. 姓名匹配-支持拼音</h4>
            <p>Datalist组件默认前值匹配，如果想要模糊匹配，需要使用可选参数中的<code>filter</code>接口修改过滤规则，可以通过插入HTML设置加粗或高亮。</p>
            <p><span class="dib vt pt5">员工姓名：</span><input id="inputPerson3" class="ui-input" list="datalistPerson3"></p>
            <datalist id="datalistPerson3">
    <!--[if IE 9]><select disabled style="display:none"><![endif]-->
    <option value="蔡伦" label="caishihao">
    <option value="郑成功" label="zhengshijun">
    <option value="李莲英" label="lilianying">
    <option value="高松正" label="gaofan.a">
    <option value="郑工" label="zhenggong">
    <option value="陈晓芳" label="chenfang.c">
    <option value="李琳琳" label="liyilin">
    <option value="彭大帅" label="pengyule">
    <!--[if IE 9]></select><![endif]-->
</datalist>
            <p>可以把拼音数据写在<code>label</code>属性上，然后使用<code>filter</code>参数进行匹配过滤。</p>
            <pre>&lt;input id="inputPerson3" class="ui-input" list="datalistPerson3"&gt;
&lt;datalist id="datalistPerson3"&gt;
    &lt;option value="蔡伦" label="caishihao"&gt;
    &lt;option value="郑成功" label="zhengshijun"&gt;
    &lt;option value="李莲英" label="lilianying"&gt;
    &lt;option value="高松正" label="gaofan.a"&gt;
    &lt;option value="郑工" label="zhenggong"&gt;
    &lt;option value="陈晓芳" label="chenfang.c"&gt;
    &lt;option value="李琳琳" label="liyilin"&gt;
    &lt;option value="彭大帅" label="pengyule"&gt;
&lt;/datalist&gt;</pre>
            <pre><span class="green">// 支持拼音</span>
new Datalist('#inputPerson3', {
    <span class="green">// data是完整数据，value是输入框的值</span>
    filter: function (data, value) {
        if (!value) {
            return data;
        }
        return data.filter(function (obj) {
            var valueReplace = obj.value.replace(value, '&lt;mark&gt;' + value + '&lt;/mark&gt;');
            var valueLabel = obj.label.replace(value, '&lt;mark&gt;' + value + '&lt;/mark&gt;');
            if (valueReplace != obj.value || valueLabel != obj.label) {
                obj.value = valueReplace;
                obj.label = valueLabel;

                return true;
            }

            return false;
        });
    }
});</pre>
            <p><strong>说明</strong></p>
            <p>默认<code>label</code>值为灰色小字，如果有特殊需要想要改变列表的样式，可以通过特殊的类名进行重置。</p>
            <p>规则是这样的，列表显示的时候，会基于<code>&lt;input&gt;</code>输入框元素的<code>id</code>值生成一个关联类名。例如<code>&lt;input&gt;</code>元素的<code>id</code>值是<code>whatever</code>，则列表容器会包含一个类名<code>ui-datalist-whatever</code>；又如这里的id是<code>inputPerson3</code>，则列表容器会有类名<code>ui-datalist-input-person3</code>。</p>
            <p><img src="https://qidian.qpic.cn/qidian_common/349573/b17417985b5158ba335afc69b061636c/0" alt="类名添加示意"></p>

            <h4>4. 时间选择-部分选项禁用测试</h4>
            <p>凌晨00:00~05:59不能选择：<span class="ui-input input-time-x"><input id="inputHour" list="datalistHour" results="24" value="06">:<input id="inputMinute" list="datalistMinute" results="60" value="00"></span></p>
<style>
.input-time-x {
    border: 1px solid #d0d0d5;
    border-radius: 4px;
}
.input-time-x > input {
    width: 4em;
    border: 0;
    text-align: center;
}
</style>
<datalist id="datalistHour">
    <!--[if IE 9]><select disabled style="display:none"><![endif]-->
    <option value="00" disabled>
    <option value="01" disabled>
    <option value="02" disabled>
    <option value="03" disabled>
    <option value="04" disabled>
    <option value="05" disabled>
    <option value="06">
    <option value="07">
    <option value="08">
    <option value="09">
    <option value="10">
    <option value="11">
    <option value="12">
    <option value="13">
    <option value="14">
    <option value="15">
    <option value="16">
    <option value="17">
    <option value="18">
    <option value="19">
    <option value="20">
    <option value="21">
    <option value="22">
    <option value="23">
    <!--[if IE 9]></select><![endif]-->
</datalist>
<datalist id="datalistMinute">
    <!--[if IE 9]><select disabled style="display:none"><![endif]-->
    <option value="00">
    <option value="01">
    <option value="02">
    <option value="03">
    <option value="04">
    <option value="05">
    <option value="06">
    <option value="07">
    <option value="08">
    <option value="09">
    <option value="10">
    <!--[if IE 9]></select><![endif]-->
</datalist>
<script>
(function () {
    var eleList = document.querySelector('#datalistMinute select') || document.getElementById('datalistMinute');
    for (var index = 11; index < 60; index++) {
        var eleOption = document.createElement('option');
        eleOption.setAttribute('value', index);

        eleList.appendChild(eleOption);
    }
})();
</script>

            <p>HTML代码如下：</p>
            <pre><span class="green">&lt;!-- 输入框部分 --&gt;</span>
&lt;span class="ui-input input-time-x"&gt;&lt;input id="inputHour" list="datalistHour" results="24" value="06"&gt;:&lt;input id="inputMinute" list="datalistMinute" results="60" value="00"&gt;&lt;/span&gt;

<span class="green">&lt;!-- 数据部分，使用原生&lt;datalist&gt;元素 --&gt;</span>
<span class="green">&lt;!-- 小时数据 --&gt;</span>
&lt;datalist id="datalistHour"&gt;
    &lt;option value="00" disabled&gt;
    &lt;option value="01" disabled&gt;
    <span class="gray">...</span>
    &lt;option value="23"&gt;
&lt;/datalist&gt;
<span class="green">&lt;!-- 分钟数据 --&gt;</span>
&lt;datalist id="datalistMinute"&gt;
    &lt;option value="00"&gt;
    &lt;option value="01"&gt;
    <span class="gray">...</span>
    &lt;option value="59"&gt;
&lt;/datalist&gt;
</pre>
            <p>然后CSS部分，需要微调下LuLu UI默认的输入框样式：</p>
            <pre>.input-time-x {
    border: 1px solid #d0d0d5;
    border-radius: 4px;
}
.input-time-x > input {
    width: 4em;
    border: 0;
    text-align: center;
}</pre>
            <p>JS非常简单：</p>
            <pre>new Datalist('#inputHour');
new Datalist('#inputMinute');</pre>




            <h3>Autocomplete功能</h3>

            <h4>1. 原生autocomplete行为</h4>
            <p>会记忆当前输入框元素表单提交过的值，并在下一次连续点击的时候出现历史提交的数据列表，可以使用Del键删除某一项数据，若想清空所有数据，可以使用实例对象暴露的<code>removeStore()</code>方法。</p>
            <h5>案例</h5>
            <p>输入内容并回车，触发表单的submit提交事件，此时，再次点击输入框，之前提交的数据会作为列表项呈现出来。</p>
            <form>
                <span class="ui-input ui-input-search" align="right">
                    <input type="search" id="inputSimple" name="search" results="5" placeholder="输入内容并回车" required>
                    <button type="submit" class="ui-icon-search">搜索</button>
                </span>
            </form>
            <p>
                <button id="clearStore" class="ui-button" data-type="primary" disabled>清除当前数据</button>
                <button id="clearAllStore" class="ui-button ml10" data-type="primary">清除所有数据</button>
            </p>
            <pre>&lt;form&gt;
    &lt;span class="ui-input ui-input-search" align="right"&gt;
        &lt;input type="search" id="inputSimple" name="search" results="5" placeholder="输入内容并回车" required&gt;
        &lt;button type="submit" class="ui-icon-search"&gt;搜索&lt;/button&gt;
    &lt;/span&gt;
&lt;/form&gt;

&lt;button id="clearStore" class="ui-button" data-type="primary" disabled&gt;清除当前数据&lt;/button&gt;
&lt;button id="clearAllStore" class="ui-button" data-type="primary"&gt;清除所有数据&lt;/button&gt;</pre>
            <pre><span class="green">// 浏览器原生autocomplete模拟</span>
var datalistSimple = new Datalist('#inputSimple');

<span class="green">// 其实就上面一行就可以了，下面代码是演示如何清除数据
// 两个清除按钮</span>
var eleBtnClearStore = document.getElementById('clearStore');
var eleBtnClearAllStore = document.getElementById('clearAllStore');

eleBtnClearStore.addEventListener('click', function () {
    <span class="green">// 删除当前实例对象对应输入框里面的值</span>
    datalistSimple.removeStore();

    new LightTip().success('“' + datalistSimple.value() + '”这条搜索记录已经从本地数据中清除');
});

eleBtnClearAllStore.addEventListener('click', function () {
    <span class="green">// 传入参数true表示删除所有数据</span>
    datalistSimple.removeStore(<mark>true</mark>);

    new LightTip().success('所有搜索历史记录已经从本地数据中清除');
});</pre>
            <pre><span class="green">// 表单提交后存储的提示处理
// 实际开发无需该提示</span>
form.addEventListener('submit', function (event) {
    event.preventDefault();

    new LightTip().success('当前搜索内容已经在本地存储，再次点击或输入，可以触发匹配');
});</pre>
            <h5>其他说明</h5>
            <p>这里的autocomplete自动完成功能采用和浏览器自身一样的实现机制，包括：</p>
            <ol>
                <li><code>&lt;form&gt;</code>元素<code>submit</code>事件执行的时候，才会记录该数据；</li>
                <li>数据查询key通过<code>name</code>属性值进行匹配；</li>
                <li><code>autocomplete="off"</code>可以关闭自动提示和记忆功能。</li>
                <li>操作交互也和浏览器内置交互一致，例如，输入框2次点击，显示对应列表，上下键选择，回车赋值等。</li>
            </ol>
            <p>换句话说，就是把浏览器内置的autocomplete功能美化了下，所谓UI组件，本来就应该只关注UI。</p>
            <p>当选择列表内容之后，会触发<code>&lt;input&gt;</code>输入框的<code>change</code>和<code>input</code>事件。</p>

            <h4>2. Ajax autocomplate功能</h4>
            <form action="https://www.qidian.com/search" target="_qidian">
                <input class="ui-input mr10" type="search" id="inputAjaxSearch" name="kw" size="30" placeholder="输入字母"><button type="submit" class="ui-button" data-type="primary">搜索</button>
            </form>
            <pre>&lt;form&gt;
    &lt;input class="ui-input" type="search" id="ajaxSearch" name="kw" placeholder="输入字母"&gt;
    &lt;button type="submit" class="ui-button" data-type="primary"&gt;搜索&lt;/button&gt;
&lt;/form&gt;</pre>
            <pre>var eleSearch = document.getElementById('ajaxSearch');
new Datalist(eleSearch, {
    data: {
        url: '/search',
        data: {
            userid: 1
        },
        success: function() {
            console.log('success callback success!');
        }
    }
});</pre>
            <p>这里的列表数据由后端提供，前端发送搜索内容给后端，后端决定要显示的数据。</p>

            <h5>参数</h5>

            <p>当可选参数<code>data</code>类型为纯对象，并且有<code>url</code>属性的时候，Datalist组件会认为是Ajax请求列表。</p>

            <p>后端返回值必须是'json'类型数据。</p>
            <p><code>data</code>对象支持下面4个属性：</p>
            <dl>
                <dt>url</dt>
                <dd>字符串。必需。请求后端数据的地址。注意，IE9浏览器不支持跨域的URL地址。</dd>
                <dt>data</dt>
                <dd>纯对象。可选。请求后端数据时发送的数据。其中输入框数据发送是组件内置的，默认使用<code>&lt;input&gt;</code>元素的<code>name</code>属性值作为字段发送数据，如果缺省，使用字符<code>k</code>代替。</dd>
                <dt>success</dt>
                <dd>函数。可选。成功回调，支持一个参数，为后端返回的JSON数据。</dd>
                <dt>error</dt>
                <dd>函数。可选。失败回调。</dd>
            </dl>
            <h5>更多说明</h5>
            <p>然而，我们实际使用的时候不会像上面这么简单，因此不同项目不同开发返回的数据格式和后台接口都是不一样的。</p>
            <p>本Datalist组件默认支持的JSON数据结构如下：</p>
            <pre>{
    data: []
}</pre>
            <p>但有些项目返回的JSON数据中的列表数组在更深的层级中，例如：</p>
            <pre>{
    data: {
        pageInfo: {},
        data: []
    }
}</pre>
            <p>也就是数据列表需要使用<code>data.data</code>获取，此时，我们可以使用<code>filter</code>参数处理，<code>filter</code>参数是个专门对数据进行过滤和处理的方法，例如，我们可以这样：</p>
            <pre>new Datalist(eleSearch, {
    data: {
        url: '/search'
    },
    filter: function(data) {
        return data.data;
    }
});</pre>
            <p>如果更进一步，<code>data.data</code>数组中的对象属性名不是<code>value</code>（必须），也不是<code>label</code>（可缺省），而是其他，例如：</p>
            <pre>{
    data: {
        pageInfo: {},
        data: [{
            content: 'aaaaa'
        }, {
            content: 'bbbbb'
        }]
    }
}</pre>
            <p>此时，同样在<code>filter</code>方法中进行处理，返回Datalist需要的数组格式就可以了：</p>
            <pre>new Datalist($('#inputAjaxSearch'), {
    data: {
        url: '/search'
    },
    filter: function(data) {
        return data.data.map(function (obj) {
            return {
                value: obj.content
            }
        });
    }
});</pre>

            <h3>自动补全功能</h3>
            <p>例如下面的邮箱自动补全功能：</p>
            <p>邮箱：<input type="email" id="inputEmail" class="ui-input" size="30"></p>
            <pre>&lt;input type="email" id="inputEmail" class="ui-input" size="30"&gt;</pre>
            <pre><span class="green">// 邮箱匹配</span>
new Datalist('#inputEmail', {
    data: ['qq.com', 'gmail.com', '126.com', '163.com'],
    placeholder: false,
    filter: function (data, value) {
        value = value.split('@')[0];

        if (!value) {
            return [];
        }

        return data.map(function (domain) {
            return {
                value: value + '@' + domain
            };
        });
    }
});</pre>

            <h3>is-datalist与初始化</h3>

            <p>对于 Vue 或 Preact 等框架，直接获取 DOM 元素然后进行组件初始化是不太方便的，此时，可以使用 <code>is-datalist</code> 属性和 <code>connected</code> 自定义事件进行处理。</p>

            <p>例如：</p>

            <div id="app">
                <template v-if="1">
                    <input class="ui-input" :results="results" @connected="setParams" is-datalist>
                </template>
            </div>

            <pre>&lt;div id="app"&gt;
    &lt;template v-if="1"&gt;
        &lt;input class="ui-input" :results="results" @connected="setParams" <mark>is-datalist</mark>&gt;
    &lt;/template&gt;
&lt;/div&gt;</pre>
            <pre>new Vue({
  el: '#app',
  data: {
    results: 5
  },
  methods: {
    setParams: function (event) {
        new Datalist(event.target, {
            data: [{
                value: '蔡伦',
                id: 1
            }, ..., {
                value: '彭大帅',
                id: 7
            }]
        });
    }
  }
});</pre>

            <h3>语法和参数</h3>

            <h4>语法</h4>
            <pre>var myDatalist = new Datalist(trigger, options);</pre>

            <h4>参数</h4>
            <dl>
                <dt>trigger</dt>
                <dd>必需。Object DOM对象|String选择器。指输入框DOM元素或者输入框元素的选择器。</dd>
                <dt>options</dt>
                <dd>可选。Object纯对象。可选参数具体见下表：</dd>
            </dl>
            <table width="100%" class="ui-table">
              <tr>
                <th scope="col" width="80">参数名称</th>
                <th scope="col" width="120">支持类型</th>
                <th scope="col" width="110">默认值</th>
                <th scope="col">释义</th>
              </tr>
              <tr>
                <td>data</td>
                <td>String|<wbr>Array|<wbr>Function|<wbr>Object</td>
                <td>'auto'</td>
                <td><p>列表的数据，默认<code>auto</code>表示根据<code>trigger</code>元素不同参数值进行数据类型识别。</p>
                <p>可以指定数据，无论是静态数组，还是函数，最终返回数据结构都要如下：</p>
                <code class="db mt5 mb5">{<br>
                &nbsp;&nbsp;<span class="green">// 可选，禁用</span><br>
                &nbsp;&nbsp;disabled: '',  <br>
                &nbsp;&nbsp;<span class="green">// 可选，右侧小文字</span><br>
                &nbsp;&nbsp;label: '',  <br>
                &nbsp;&nbsp;<span class="green">// 必须</span><br>
                &nbsp;&nbsp;value: ''   <br>
                }</code>
                <p>可以指定其他自定义数据，在输入框的<code>'change'</code><wbr>或<code>'input'</code><wbr>事件中使用<code>event.detail</code>或者<code>myDatalist<wbr>.data[<wbr>myDatalist<wbr>.params<wbr>.index<wbr>]</code>获取选中的值。</p>
                </td>
              </tr>
              <tr>
                <td>max</td>
                <td>String|<wbr>Number</td>
                <td>8</td>
                <td>最多显示的列表项条数，默认8条。使用关键字<code>'auto'</code>表示数据没有限制。可以使用HTML原生的类目个数属性<code>results</code><wbr>重置显示的条目数，例如<wbr><code>results<wbr>=<wbr>"5"</code>最多显示5条列表数据。</td>
              </tr>
              <tr>
                <td>width</td>
                <td>String|<wbr>Number</td>
                <td>'auto'</td>
                <td>列表的宽度，默认<code>'auto'</code><wbr>表示和<code>trigger</code><wbr>触发元素的宽度一致。</td>
              </tr>
              <tr>
                <td>container</td>
                <td>Element|<wbr>String</td>
                <td>document<wbr>.body</td>
                <td>DOM元素对象，指装载列表的容器，默认是<code>&lt;body&gt;</code><wbr>元素，该参数值也可以是元素的选择器。</td>
              </tr>
              <tr>
                <td>place<wbr>holder</td>
                <td>Boolean</td>
                <td>'auto'</td>
                <td>是否是占位符交互模式（点击输入框值清空使用<wbr>placeholder<wbr>属性值代替），默认<code>'auto'</code><wbr>表示自动识别，规则如下：<wbr>Autocomplete功能的参数值认为是<wbr><code>false</code>，其他功能识别为<code>true</code>。我们也可以通过实例对象暴露的<wbr><code>placeholder</code><wbr>进行设置，例如<code>myDatalist<wbr>.placeholder = false</code>。</td>
              </tr>
              <tr>
                <td>filter</td>
                <td>Function</td>
                <td><span class="db">function (data, value) { <br><span class="green">&nbsp;&nbsp;/* 首字符匹配过滤 */</span><br> }</span></td>
                <td>对现有的数据进行重新过滤或者重新组装，只要返回需要的数组就好了，数组格式和细节和<code>data</code>参数一致。其中，<code>this</code><wbr>上下文指当前实例元素，支持2个参数，<code>data</code><wbr>为需要处理的数据(也是数组格式)，<code>value</code><wbr>是输入框xss过滤后的值。</td>
              </tr>
              <tr>
                <td>onSelect</td>
                <td>Function</td>
                <td>function () {}</td>
                <td>列表选择时候的回调。<code>this</code><wbr>上下文指当前实例元素，支持3个参数，分别是选择的数据<code>data</code>，触发元素<code>trigger</code>和列表面板元素<code>target</code>。只要点击和回车才触发，上下键移动不会触发此回调。</td>
              </tr>
              <tr>
                <td>onShow</td>
                <td>Function</td>
                <td>function () {}</td>
                <td>列表显示时候触发的回调。<code>this</code><wbr>上下文指当前实例元素，支持2个参数，分别是触发元素<code>trigger</code><wbr>和列表面板元素<code>target</code>。</td>
              </tr>
              <tr>
                <td>onHide</td>
                <td>Function</td>
                <td>function () {}</td>
                <td>列表隐藏时候触发的回调。<code>this</code><wbr>上下文指当前实例元素，支持2个参数，分别是触发元素<code>trigger</code><wbr>和列表面板元素<code>target</code>。</td>
              </tr>
            </table>

            <h4>关于实例对象</h4>
            <p><code>myDatalist</code>就是实例对象，暴露了如下属性和方法：</p>
            <pre>{
    el: {
        <span class="green">// 输入框元素</span>
        trigger: null,
        input: null,
        <span class="green">// append列表的容器</span>
        container: null,
        <span class="green">// 列表面板元素</span>
        target: null
    },
    callback: {
        <span class="green">// 根据params.data生成的获得实时列表数据的方法，真正的数据源</span>
        data: function () {},
        filter: function () {},
        select: function () {},
        show: function () {},
        hide: function () {}
    },
    params: {
        width: 'auto',
        max: 8,
        <span class="green">// 可选参数和默认参数合并后的data</span>
        data: [],
        <span class="green">// 当前选中的列表所在的索引值</span>
        index: -1
    },
    <span class="green">// 交互模式是否是Placeholder模式</span>
    placeholder: true,
    <span class="green">// 当前列表显示与否</span>
    display: false,
    <span class="green">// 当前列表所使用的数据</span>
    data: [],
    <span class="green">// 存储本地输入框的值</span>
    store: function () {},
    <span class="green">// 清除本地记录，支持1个可选的value参数，有3种逻辑：
       1. 字符串内容，表示移除本地该值数据（如果有）
       2. true, 表示清空本地对应该存储
       3. undefined, 表示使用trigger输入框的value值作为移除对象</span>
    removeStore: function () {},
    <span class="green">// 根据当前value值刷新列表，可以使用data参数指定数据进行列表呈现</span>
    refresh: function (data) {},
    <span class="green">// 有value参数表示赋值，没有表示取值（xss过滤后的值）</span>
    value: function (value) {},
    <span class="green">// 事件绑定</span>
    events: function () {},
    <span class="green">// 列表定位</span>
    position: function () {},
    <span class="green">// 显示列表</span>
    show: function () {},
    <span class="green">// 隐藏列表</span>
    hide: function () {}
}</pre>
            <p>我们也可以通过<code>trigger.data.datalist</code>获取实例对象。</p>
            <pre>new Datalist(trigger);
var myDatalist = trigger.data.datalist;</pre>

            <p>Datalist组件默认关闭了边缘检测，如果希望下拉列表在浏览器外面的时候自动朝上显示，可以这么设置：</p>
            <pre>myDatalist.params.edgeAdjust = true;</pre>

            <h3>综合拓展案例</h3>

            <p>这里演示如何借助Datalist组件的筛选过滤逻辑实现其他更复杂的交互效果。</p>

            <h4>带搜索的下拉列表</h4>
<div class="ui-select" style="width:300px;">
    <a href="javascript:" id="listTrigger" class="ui-select-button"><span class="ui-select-text">企点服务迭代三(4月6日~5月5日)</span></a>
</div>
<div id="listTarget" class="ui-droplist-x" hidden>
    <div class="p10">
        <div class="ui-input ui-input-search" align="right"><input type="search"><label class="ui-icon-search">搜索</label></div>
        <div id="listBox" class="datalist-container"></div>
    </div>
</div>
            <p>使用CSS重置了一些样式，例如，绝对定位就不要了，阴影效果也不要了：</p>
            <pre>.datalist-container .ui-datalist {
    display: block!important;
    position: static!important;
}
.datalist-container .ui-datalist-datalist {
    margin-top: 10px;
    border: 1px solid #d0d0d5;
    box-shadow: none;
}</pre>
            <p>这里的按钮HTML直接取自Select组件UI，因为我懒：</p>
            <pre>&lt;div class="ui-select" style="width:300px;"&gt;
    &lt;a href="javascript:" id="listTrigger" class="ui-select-button"&gt;&lt;span class="ui-select-text"&gt;企点服务迭代三(4月6日~5月5日)&lt;/span&gt;&lt;/a&gt;
&lt;/div&gt;
<span class="green">&lt;!-- 下拉面板主体结构 --&gt;</span>
&lt;div id="listTarget" class="ui-droplist-x" hidden&gt;
    &lt;div class="ui-input ui-input-search" align="right"&gt;&lt;input type="search"&gt;&lt;label class="ui-icon-search"&gt;搜索&lt;/label&gt;&lt;/div&gt;
    &lt;div id="listBox" class="datalist-container"&gt;&lt;/div&gt;
&lt;/div&gt;</pre>
            <p>然后是JS代码，使用了组件体系中的Drop.js，而这里的Datalist则静态处理：</p>
            <pre><span class="green">// 下拉带搜索示意</span>
var listTrigger = document.getElementById('listTrigger');
var listTarget = document.getElementById('listTarget');
<span class="green">// 尺寸</span>
listTarget.style.width = listTrigger.clientWidth + 'px';
<span class="green">// 下拉处理</span>
new Drop(listTrigger, listTarget, {
    eventType: 'click',
    onShow: function (trigger, target) {
        var input = target.querySelector('input');
        var drop = this;

        if (!this.datalist) {
            <span class="green">// 只构造一次</span>
            var datalist = new Datalist(input, {
                data: data,
                width: 280,
                container: '#listBox',
                max: 'auto',
                filter: function (data, value) {
                    return data.filter(function (obj) {
                        return value == '' || obj.value.indexOf(value) != -1;
                    });
                },
                onSelect: function (data) {
                    var span = listTrigger.querySelector('span');
                    if (data &amp;&amp; span) {
                        span.innerHTML = data.value;
                        drop.hide();
                    }
                }
            });

            datalist.refresh();
            this.datalist = datalist;
        } else {
            input.click();
        }
    }
});</pre>

            <div class="contributors">
                <svg><use xlink:href="#icon-persons"></use></svg> <h6 class="contributors-h">本页贡献者：</h6><p id="contributorsP" class="contributors-p">zhangxinxu</p>
            </div>
        </article>
    </main>
    <!-- 侧边栏 -->
    <!-- 侧边栏 -->
<aside id="aside" class="aside">
    <div class="aside_main">
    	<dl class="aside_dl">
        	<dt class="aside_dt">关于</dt>
            <dd><a href="./about.design.html" class="aside_nav "><i class="icon icon_nav_msg"><svg><use xlink:href="#icon-maxcdn"></use></svg></i>命名与设计</a></dd>
            <dd><a href="./about.use.html" class="aside_nav "><i class="icon icon_nav_set"><svg><use xlink:href="#icon-wrench"></use></svg></i>使用与发布</a></dd>
        </dl>
        <dl class="aside_dl">
            <dt class="aside_dt">全局</dt>
            <dd><a href="./apis.colour.html" class="aside_nav "><i class="icon icon_nav_ux"><svg><use xlink:href="#icon-delicious"></use></svg></i>颜色</a></dd>
        </dl>
        <dl class="aside_dl">
            <dt class="aside_dt">布局</dt>
            <dd><a href="./apis.table.html" class="aside_nav "><i class="icon icon_nav_ux"><svg><use xlink:href="#icon-table"></use></svg></i>Table表格</a></dd>
        </dl>
        <dl class="aside_dl">
            <dt class="aside_dt">控件</dt>
            <dd><a href="./apis.button.html" class="aside_nav "><i class="icon icon_nav_ux"><svg><use xlink:href="#icon-caret-square-o-right"></use></svg></i>Button按钮</a></dd>
            <dd><a href="./apis.input.html" class="aside_nav "><i class="icon icon_nav_ux"><svg><use xlink:href="#icon-tasks"></use></svg></i>Input文本框</a></dd>
            <dd><a href="./apis.textarea.html" class="aside_nav "><i class="icon icon_nav_ux"><svg><use xlink:href="#icon-square-o"></use></svg></i>Textarea文本域</a></dd>
            <dd><a href="./apis.placeholder.html" class="aside_nav "><i class="icon icon_nav_reply"><svg><use xlink:href="#icon-product-hunt"></use></svg></i>Placeholder占位符</a></dd>
            <dd><a href="./apis.checked.html" class="aside_nav "><i class="icon icon_nav_reply"><svg><use xlink:href="#icon-check-square"></use></svg></i>Radio/Checkbox框</a></dd>
            <dd><a href="./apis.switch.html" class="aside_nav "><i class="icon icon_nav_reply"><svg><use xlink:href="#icon-toggle-on"></use></svg></i>Switch开关</a></dd>
            <dd><a href="./apis.progress.html" class="aside_nav "><i class="icon icon_nav_reply"><svg><use xlink:href="#icon-ellipsis-h"></use></svg></i>Progress进度</a></dd>
        </dl>
        <div class="aside_divide"></div>
        <dl class="aside_dl">
            <dt class="aside_dt" hidden>动态控件</dt>
            <dd><a href="./apis.select.html" class="aside_nav "><i class="icon icon_nav_user"><svg><use xlink:href="#icon-bars"></use></svg></i>Select下拉框</a></dd>
            <dd><a href="./apis.range.html" class="aside_nav "><i class="icon icon_nav_user"><svg><use xlink:href="#icon-sliders"></use></svg></i>Range范围选择</a></dd>
            <dd><a href="./apis.color.html" class="aside_nav "><i class="icon icon_nav_user"><svg><use xlink:href="#icon-eyedropper"></use></svg></i>Color颜色选择</a></dd>
            <dd><a href="./apis.datetime.html" class="aside_nav "><i class="icon icon_nav_user"><svg><use xlink:href="#icon-calendar"></use></svg></i>DateTime日期选择</a></dd>
        </dl>
        <div class="aside_divide"></div>
        <dl class="aside_dl">
            <dt class="aside_dt">组件</dt>
            <dd><a href="./apis.loading.html" class="aside_nav "><i class="icon icon_nav_reply"><svg><use xlink:href="#icon-spinner"></use></svg></i>Loading效果</a></dd>
            <dd><a href="./apis.datalist.html" class="aside_nav active"><i class="icon icon_nav_user"><svg><use xlink:href="#icon-list"></use></svg></i>Datalist数据列表</a></dd>
            <dd><a href="./apis.dialog.html" class="aside_nav "><i class="icon icon_nav_user"><svg><use xlink:href="#icon-external-link"></use></svg></i>Dialog弹框</a></dd>
            <dd><a href="./apis.tips.html" class="aside_nav "><i class="icon icon_nav_user"><svg><use xlink:href="#icon-bell"></use></svg></i>Tips/ErrorTip提示</a></dd>
            <dd><a href="./apis.lighttip.html" class="aside_nav "><i class="icon icon_nav_user"><svg><use xlink:href="#icon-bolt"></use></svg></i>LightTip轻提示</a></dd>
            <dd><a href="./apis.pagination.html" class="aside_nav "><i class="icon icon_nav_user"><svg><use xlink:href="#icon-stack"></use></svg></i>Pagination分页</a></dd>
            <dd><a href="./apis.drop.html" class="aside_nav "><i class="icon icon_nav_user"><svg><use xlink:href="#icon-dropbox"></use></svg></i>Drop等下拉</a></dd>
            <dd><a href="./apis.validate.html" class="aside_nav "><i class="icon icon_nav_user"><svg><use xlink:href="#icon-check-square-o"></use></svg></i>Validate表单验证</a></dd>
            <dd><a href="./apis.tab.html" class="aside_nav "><i class="icon icon_nav_user"><svg><use xlink:href="#icon-tags"></use></svg></i>Tab选项卡切换</a></dd>
        </dl>

        <dl class="aside_dl">
            <dt class="aside_dt">综合实例</dt>
            <dd><a href="./example.table.html" class="aside_nav "><i class="icon icon_nav_menu"><svg><use xlink:href="#icon-list-alt"></use></svg></i>表格解决方案</a></dd>
            <dd><a href="./example.form.html" class="aside_nav "><i class="icon icon_nav_source"><svg><use xlink:href="#icon-wpforms"></use></svg></i>表单解决方案</a></dd>
        </dl>
    </div>
</aside>
<script>(function () {
    // 记住滚动位置
    var eleAside = document.getElementById('aside');

    eleAside.addEventListener('click', function () {
        sessionStorage.asideScrollTop = this.scrollTop;
    });

    eleAside.scrollTop = sessionStorage.asideScrollTop;
    // IE这里设置可能没有用
    if (eleAside.scrollTop != sessionStorage.asideScrollTop) {
        setTimeout(function () {
            eleAside.scrollTop = sessionStorage.asideScrollTop;
        }, 1);
    }

    // 滚动条设置判断
    var div = document.createElement('div');
    div.style.width = '100px';
    div.style.height = '1px';
    div.style.overflow = 'auto';
    div.style.position = 'absolute';
    div.style.left = '-199px';
    var p = document.createElement('p');
    p.style.height = '20px';
    div.appendChild(p);
    document.body.appendChild(div);
    if (p.clientWidth != 100) {
        eleAside.className += ' scrollbar';
    }
    document.body.removeChild(div);
})();
</script>
</div>

<a href="#" id="backtop" class="backtop"></a>

<script src="https://qidian.gtimg.com/lulu/pure/js/common/polyfill.js"></script>
<script src="https://qidian.gtimg.com/lulu/pure/js/common/ui/Keyboard.js"></script>
<script src="https://qidian.gtimg.com/lulu/pure/js/common/ui/Select.js"></script>
<!-- 底部 -->
<script src="../pure/assets/js/mockup.js"></script>
</body>
</html>

<script src="https://qidian.gtimg.com/lulu/pure/js/common/ui/Follow.js"></script>
<script src="https://qidian.gtimg.com/lulu/pure/js/common/ui/Datalist.js"></script>
<script src="https://qidian.gtimg.com/lulu/pure/js/common/ui/LightTip.js"></script>
<script src="https://qidian.gtimg.com/lulu/pure/js/common/ui/Drop.js"></script>

<script>
var Datalist = window.Datalist;

// 姓名匹配
new Datalist('#inputPerson');

// 使用数据进行匹配
new Datalist('#inputPerson2', {
    data: [{
        value: '蔡伦',
        id: 1
    }, {
        value: '李莲英',
        id: 2
    }, {
        value: '高松正',
        id: 3
    }, {
        value: '郑工',
        id: 4
    }, {
        value: '陈晓芳',
        id: 5
    }, {
        value: '李琳琳',
        id: 6
    }, {
        value: '彭大帅',
        id: 7
    }]
});

// 演示数据参数如何传递到事件中
document.querySelector('#inputPerson2').addEventListener('change', function (event) {
    console.log('用户变化，当前用户id是：' + event.detail.id);
});


// 支持拼音
new Datalist('#inputPerson3', {
    filter: function (data, value) {
        if (!value) {
            return data;
        }
        return data.filter(function (obj) {
            var valueReplace = obj.value.replace(value, '<mark>' + value + '</mark>');
            var valueLabel = obj.label.replace(value, '<mark>' + value + '</mark>');
            if (valueReplace != obj.value || valueLabel != obj.label) {
                obj.value = valueReplace;
                obj.label = valueLabel;

                return true;
            }

            return false;
        });
    }
});

// 日期选择
var datalistHour = new Datalist('#inputHour');
var datalistMinute = new Datalist('#inputMinute');
// IE和Firefox增加滚动条的宽度
if (window.innerWidth - document.documentElement.clientWidth > 10 && typeof document.webkitHidden == 'undefined') {
    datalistHour.params.width = datalistHour.element.trigger.clientWidth + 4;
    datalistMinute.params.width = datalistMinute.element.trigger.clientWidth + 4;
}

// 本地autocomplete
var datalistSimple = new Datalist('#inputSimple');
var eleBtnClearStore = document.getElementById('clearStore');
var eleBtnClearAllStore = document.getElementById('clearAllStore');

eleBtnClearStore.addEventListener('click', function () {
    // 删除当前实例对象对应输入框里面的值
    datalistSimple.removeStore();

    if (datalistSimple.value()) {
        new LightTip().success('“' + datalistSimple.value() + '”这条搜索记录已经从本地数据中清除');
    }
});

eleBtnClearAllStore.addEventListener('click', function () {
    // 传入参数true表示删除所有数据
    datalistSimple.removeStore(true);

    new LightTip().success('所有搜索历史记录已经从本地数据中清除');
});

// 表单提交后存储的提示处理
// 实际开发无需该提示
var eleFormSimple = datalistSimple.element.input.closest('form');
if (eleFormSimple) {
    eleFormSimple.addEventListener('submit', function (event) {
        event.preventDefault();

        new LightTip().success('当前搜索内容已经在本地存储，再次点击或输入，可以触发匹配');

        setTimeout(function () {
            eleFormSimple.reset();
        }, 17);
    });

    if (typeof this.checkValidity == 'function') {
        eleFormSimple.addEventListener('input', function () {
            eleBtnClearStore.disabled = !this.checkValidity();
        });
    } else {
        // IE9
        datalistSimple.element.input.addEventListener('input', function () {
            eleBtnClearStore.disabled = !this.value;
        });
    }
}

// ajax autocomplete
var eleInputAjaxSearch = document.getElementById('inputAjaxSearch');

new Datalist(eleInputAjaxSearch, {
    data: {
        url: 'https://www.zhangxinxu.com/sp/lulu/mockup/common/cgi/search.php',
        data: {
            userid: 1
        },
        success: function () {
            console.log('success callback success!');
        },
        error: function (status) {
            console.error('error:' + status);
        }
    }
});

// 自动补全
// 邮箱匹配
new Datalist('#inputEmail', {
    data: ['qq.com', 'gmail.com', '126.com', '163.com'],
    placeholder: false,
    filter: function (data, value) {
        value = value.split('@')[0];

        if (!value) {
            return [];
        }

        return data.map(function (domain) {
            return {
                value: value + '@' + domain
            };
        });
    }
});


// 数据
var data = [{
    label: 'top1',
    value: '企点服务迭代三(4月6日~5月5日)'
}, {
    label: 'top2',
    value: '企点服务迭代二(当前迭代)'
}, {
    label: 'top3',
    value: '企点移动端技术需求池(当前迭代)'
}, {
    label: 'top4',
    value: '企点服务移动端迭代一'
}, {
    label: 'top5',
    value: '企点服务Q1冲刺迭代二(当前迭代)'
}, {
    label: 'top6',
    value: '企点服务Q1冲刺迭代一'
}, {
    label: 'top7',
    value: '技术类需求(当前迭代)'
}, {
    label: 'top8',
    value: '其他杂项工作'
}, {
    label: 'top9',
    value: '需求池(当前迭代)'
}, {
    label: 'top10',
    value: '市场痛点问题池(当前迭代)'
}, {
    label: 'top11',
    value: '视觉体验迭代'
}];

// 下拉带搜索示意
var eleListTrigger = document.getElementById('listTrigger');
var eleListTarget = document.getElementById('listTarget');
var eleListBox = document.getElementById('listBox');
// 尺寸
eleListTarget.style.width = eleListTrigger.clientWidth + 'px';
// 下拉处理
new Drop(eleListTrigger, eleListTarget, {
    eventType: 'click',
    onShow: function (trigger, target) {
        var input = target.querySelector('input');
        var drop = this;

        if (!this.datalist) {
            // 只构造一次
            var datalist = new Datalist(input, {
                data: data,
                width: 280,
                container: eleListBox,
                max: 'auto',
                filter: function (data, value) {
                    return data.filter(function (obj) {
                        return value == '' || obj.value.indexOf(value) != -1;
                    });
                },
                onSelect: function (data) {
                    var span = eleListTrigger.querySelector('span');
                    if (data && span) {
                        span.innerHTML = data.value;
                        drop.hide();
                    }
                }
            });

            datalist.refresh();
            this.datalist = datalist;
        } else {
            input.click();
        }
    }
});
</script>

<script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
<script>
new Vue({
  el: '#app',
  data: {
    results: 5
  },
  methods: {
    setParams: function (event) {
        new Datalist(event.target, {
            data: [{
                value: '蔡伦',
                id: 1
            }, {
                value: '李莲英',
                id: 2
            }, {
                value: '高松正',
                id: 3
            }, {
                value: '郑工',
                id: 4
            }, {
                value: '陈晓芳',
                id: 5
            }, {
                value: '李琳琳',
                id: 6
            }, {
                value: '彭大帅',
                id: 7
            }]
        });
    }
  }
});
</script>